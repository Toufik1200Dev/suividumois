{"ast":null,"code":"import _objectSpread from\"C:/Users/rahma/OneDrive/Desktop/suivi du mois/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{collection,doc,setDoc,getDoc,getDocs,query,where,orderBy,addDoc,updateDoc,deleteDoc}from'firebase/firestore';import{db}from'./config';// Save monthly activity data\nexport const saveMonthlyData=async(userId,year,month,data)=>{try{const monthId=\"\".concat(year,\"-\").concat(String(month).padStart(2,'0'));const docRef=doc(db,'monthlyData',\"\".concat(userId,\"_\").concat(monthId));await setDoc(docRef,{userId:userId,year:year,month:month,data:data,updatedAt:new Date()},{merge:true});return{success:true};}catch(error){console.error('Error saving monthly data:',error);return{success:false,error:error.message};}};// Get monthly activity data\nexport const getMonthlyData=async(userId,year,month)=>{try{const monthId=\"\".concat(year,\"-\").concat(String(month).padStart(2,'0'));const docRef=doc(db,'monthlyData',\"\".concat(userId,\"_\").concat(monthId));const docSnap=await getDoc(docRef);if(docSnap.exists()){return{success:true,data:docSnap.data().data||{}};}else{return{success:true,data:{}};}}catch(error){console.error('Error getting monthly data:',error);return{success:false,error:error.message};}};// Get all employees (for admin dashboard)\nexport const getAllEmployees=async()=>{try{const usersRef=collection(db,'users');const q=query(usersRef,where('role','==','employee'));const querySnapshot=await getDocs(q);const employees=[];querySnapshot.forEach(doc=>{employees.push(_objectSpread({id:doc.id},doc.data()));});return{success:true,employees:employees};}catch(error){console.error('Error getting employees:',error);return{success:false,error:error.message};}};// Get all users (for admin dashboard)\nexport const getAllUsers=async()=>{try{const usersRef=collection(db,'users');const querySnapshot=await getDocs(usersRef);const users=[];querySnapshot.forEach(doc=>{users.push(_objectSpread({id:doc.id},doc.data()));});return{success:true,users:users};}catch(error){console.error('Error getting users:',error);return{success:false,error:error.message};}};// Update user status\nexport const updateUserStatus=async(userId,isActive)=>{try{const userRef=doc(db,'users',userId);await updateDoc(userRef,{isActive:isActive,updatedAt:new Date()});return{success:true};}catch(error){console.error('Error updating user status:',error);return{success:false,error:error.message};}};// Export user data to CSV format\nexport const exportUserData=async(userId,year,month)=>{try{const monthId=\"\".concat(year,\"-\").concat(String(month).padStart(2,'0'));const docRef=doc(db,'monthlyData',\"\".concat(userId,\"_\").concat(monthId));const docSnap=await getDoc(docRef);if(docSnap.exists()){const data=docSnap.data();return{success:true,data:data};}else{return{success:true,data:null};}}catch(error){console.error('Error exporting user data:',error);return{success:false,error:error.message};}};","map":{"version":3,"names":["collection","doc","setDoc","getDoc","getDocs","query","where","orderBy","addDoc","updateDoc","deleteDoc","db","saveMonthlyData","userId","year","month","data","monthId","concat","String","padStart","docRef","updatedAt","Date","merge","success","error","console","message","getMonthlyData","docSnap","exists","getAllEmployees","usersRef","q","querySnapshot","employees","forEach","push","_objectSpread","id","getAllUsers","users","updateUserStatus","isActive","userRef","exportUserData"],"sources":["C:/Users/rahma/OneDrive/Desktop/suivi du mois/src/firebase/firestoreService.js"],"sourcesContent":["import { \r\n  collection, \r\n  doc, \r\n  setDoc, \r\n  getDoc, \r\n  getDocs, \r\n  query, \r\n  where, \r\n  orderBy,\r\n  addDoc,\r\n  updateDoc,\r\n  deleteDoc\r\n} from 'firebase/firestore';\r\nimport { db } from './config';\r\n\r\n// Save monthly activity data\r\nexport const saveMonthlyData = async (userId, year, month, data) => {\r\n  try {\r\n    const monthId = `${year}-${String(month).padStart(2, '0')}`;\r\n    const docRef = doc(db, 'monthlyData', `${userId}_${monthId}`);\r\n    \r\n    await setDoc(docRef, {\r\n      userId: userId,\r\n      year: year,\r\n      month: month,\r\n      data: data,\r\n      updatedAt: new Date()\r\n    }, { merge: true });\r\n    \r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('Error saving monthly data:', error);\r\n    return { success: false, error: error.message };\r\n  }\r\n};\r\n\r\n// Get monthly activity data\r\nexport const getMonthlyData = async (userId, year, month) => {\r\n  try {\r\n    const monthId = `${year}-${String(month).padStart(2, '0')}`;\r\n    const docRef = doc(db, 'monthlyData', `${userId}_${monthId}`);\r\n    const docSnap = await getDoc(docRef);\r\n    \r\n    if (docSnap.exists()) {\r\n      return {\r\n        success: true,\r\n        data: docSnap.data().data || {}\r\n      };\r\n    } else {\r\n      return {\r\n        success: true,\r\n        data: {}\r\n      };\r\n    }\r\n  } catch (error) {\r\n    console.error('Error getting monthly data:', error);\r\n    return { success: false, error: error.message };\r\n  }\r\n};\r\n\r\n// Get all employees (for admin dashboard)\r\nexport const getAllEmployees = async () => {\r\n  try {\r\n    const usersRef = collection(db, 'users');\r\n    const q = query(usersRef, where('role', '==', 'employee'));\r\n    const querySnapshot = await getDocs(q);\r\n    \r\n    const employees = [];\r\n    querySnapshot.forEach((doc) => {\r\n      employees.push({\r\n        id: doc.id,\r\n        ...doc.data()\r\n      });\r\n    });\r\n    \r\n    return {\r\n      success: true,\r\n      employees: employees\r\n    };\r\n  } catch (error) {\r\n    console.error('Error getting employees:', error);\r\n    return { success: false, error: error.message };\r\n  }\r\n};\r\n\r\n// Get all users (for admin dashboard)\r\nexport const getAllUsers = async () => {\r\n  try {\r\n    const usersRef = collection(db, 'users');\r\n    const querySnapshot = await getDocs(usersRef);\r\n    \r\n    const users = [];\r\n    querySnapshot.forEach((doc) => {\r\n      users.push({\r\n        id: doc.id,\r\n        ...doc.data()\r\n      });\r\n    });\r\n    \r\n    return {\r\n      success: true,\r\n      users: users\r\n    };\r\n  } catch (error) {\r\n    console.error('Error getting users:', error);\r\n    return { success: false, error: error.message };\r\n  }\r\n};\r\n\r\n// Update user status\r\nexport const updateUserStatus = async (userId, isActive) => {\r\n  try {\r\n    const userRef = doc(db, 'users', userId);\r\n    await updateDoc(userRef, {\r\n      isActive: isActive,\r\n      updatedAt: new Date()\r\n    });\r\n    \r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('Error updating user status:', error);\r\n    return { success: false, error: error.message };\r\n  }\r\n};\r\n\r\n// Export user data to CSV format\r\nexport const exportUserData = async (userId, year, month) => {\r\n  try {\r\n    const monthId = `${year}-${String(month).padStart(2, '0')}`;\r\n    const docRef = doc(db, 'monthlyData', `${userId}_${monthId}`);\r\n    const docSnap = await getDoc(docRef);\r\n    \r\n    if (docSnap.exists()) {\r\n      const data = docSnap.data();\r\n      return {\r\n        success: true,\r\n        data: data\r\n      };\r\n    } else {\r\n      return {\r\n        success: true,\r\n        data: null\r\n      };\r\n    }\r\n  } catch (error) {\r\n    console.error('Error exporting user data:', error);\r\n    return { success: false, error: error.message };\r\n  }\r\n};\r\n"],"mappings":"kIAAA,OACEA,UAAU,CACVC,GAAG,CACHC,MAAM,CACNC,MAAM,CACNC,OAAO,CACPC,KAAK,CACLC,KAAK,CACLC,OAAO,CACPC,MAAM,CACNC,SAAS,CACTC,SAAS,KACJ,oBAAoB,CAC3B,OAASC,EAAE,KAAQ,UAAU,CAE7B;AACA,MAAO,MAAM,CAAAC,eAAe,CAAG,KAAAA,CAAOC,MAAM,CAAEC,IAAI,CAAEC,KAAK,CAAEC,IAAI,GAAK,CAClE,GAAI,CACF,KAAM,CAAAC,OAAO,IAAAC,MAAA,CAAMJ,IAAI,MAAAI,MAAA,CAAIC,MAAM,CAACJ,KAAK,CAAC,CAACK,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,CAAE,CAC3D,KAAM,CAAAC,MAAM,CAAGpB,GAAG,CAACU,EAAE,CAAE,aAAa,IAAAO,MAAA,CAAKL,MAAM,MAAAK,MAAA,CAAID,OAAO,CAAE,CAAC,CAE7D,KAAM,CAAAf,MAAM,CAACmB,MAAM,CAAE,CACnBR,MAAM,CAAEA,MAAM,CACdC,IAAI,CAAEA,IAAI,CACVC,KAAK,CAAEA,KAAK,CACZC,IAAI,CAAEA,IAAI,CACVM,SAAS,CAAE,GAAI,CAAAC,IAAI,CAAC,CACtB,CAAC,CAAE,CAAEC,KAAK,CAAE,IAAK,CAAC,CAAC,CAEnB,MAAO,CAAEC,OAAO,CAAE,IAAK,CAAC,CAC1B,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,4BAA4B,CAAEA,KAAK,CAAC,CAClD,MAAO,CAAED,OAAO,CAAE,KAAK,CAAEC,KAAK,CAAEA,KAAK,CAACE,OAAQ,CAAC,CACjD,CACF,CAAC,CAED;AACA,MAAO,MAAM,CAAAC,cAAc,CAAG,KAAAA,CAAOhB,MAAM,CAAEC,IAAI,CAAEC,KAAK,GAAK,CAC3D,GAAI,CACF,KAAM,CAAAE,OAAO,IAAAC,MAAA,CAAMJ,IAAI,MAAAI,MAAA,CAAIC,MAAM,CAACJ,KAAK,CAAC,CAACK,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,CAAE,CAC3D,KAAM,CAAAC,MAAM,CAAGpB,GAAG,CAACU,EAAE,CAAE,aAAa,IAAAO,MAAA,CAAKL,MAAM,MAAAK,MAAA,CAAID,OAAO,CAAE,CAAC,CAC7D,KAAM,CAAAa,OAAO,CAAG,KAAM,CAAA3B,MAAM,CAACkB,MAAM,CAAC,CAEpC,GAAIS,OAAO,CAACC,MAAM,CAAC,CAAC,CAAE,CACpB,MAAO,CACLN,OAAO,CAAE,IAAI,CACbT,IAAI,CAAEc,OAAO,CAACd,IAAI,CAAC,CAAC,CAACA,IAAI,EAAI,CAAC,CAChC,CAAC,CACH,CAAC,IAAM,CACL,MAAO,CACLS,OAAO,CAAE,IAAI,CACbT,IAAI,CAAE,CAAC,CACT,CAAC,CACH,CACF,CAAE,MAAOU,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,6BAA6B,CAAEA,KAAK,CAAC,CACnD,MAAO,CAAED,OAAO,CAAE,KAAK,CAAEC,KAAK,CAAEA,KAAK,CAACE,OAAQ,CAAC,CACjD,CACF,CAAC,CAED;AACA,MAAO,MAAM,CAAAI,eAAe,CAAG,KAAAA,CAAA,GAAY,CACzC,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAGjC,UAAU,CAACW,EAAE,CAAE,OAAO,CAAC,CACxC,KAAM,CAAAuB,CAAC,CAAG7B,KAAK,CAAC4B,QAAQ,CAAE3B,KAAK,CAAC,MAAM,CAAE,IAAI,CAAE,UAAU,CAAC,CAAC,CAC1D,KAAM,CAAA6B,aAAa,CAAG,KAAM,CAAA/B,OAAO,CAAC8B,CAAC,CAAC,CAEtC,KAAM,CAAAE,SAAS,CAAG,EAAE,CACpBD,aAAa,CAACE,OAAO,CAAEpC,GAAG,EAAK,CAC7BmC,SAAS,CAACE,IAAI,CAAAC,aAAA,EACZC,EAAE,CAAEvC,GAAG,CAACuC,EAAE,EACPvC,GAAG,CAACe,IAAI,CAAC,CAAC,CACd,CAAC,CACJ,CAAC,CAAC,CAEF,MAAO,CACLS,OAAO,CAAE,IAAI,CACbW,SAAS,CAAEA,SACb,CAAC,CACH,CAAE,MAAOV,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,0BAA0B,CAAEA,KAAK,CAAC,CAChD,MAAO,CAAED,OAAO,CAAE,KAAK,CAAEC,KAAK,CAAEA,KAAK,CAACE,OAAQ,CAAC,CACjD,CACF,CAAC,CAED;AACA,MAAO,MAAM,CAAAa,WAAW,CAAG,KAAAA,CAAA,GAAY,CACrC,GAAI,CACF,KAAM,CAAAR,QAAQ,CAAGjC,UAAU,CAACW,EAAE,CAAE,OAAO,CAAC,CACxC,KAAM,CAAAwB,aAAa,CAAG,KAAM,CAAA/B,OAAO,CAAC6B,QAAQ,CAAC,CAE7C,KAAM,CAAAS,KAAK,CAAG,EAAE,CAChBP,aAAa,CAACE,OAAO,CAAEpC,GAAG,EAAK,CAC7ByC,KAAK,CAACJ,IAAI,CAAAC,aAAA,EACRC,EAAE,CAAEvC,GAAG,CAACuC,EAAE,EACPvC,GAAG,CAACe,IAAI,CAAC,CAAC,CACd,CAAC,CACJ,CAAC,CAAC,CAEF,MAAO,CACLS,OAAO,CAAE,IAAI,CACbiB,KAAK,CAAEA,KACT,CAAC,CACH,CAAE,MAAOhB,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,sBAAsB,CAAEA,KAAK,CAAC,CAC5C,MAAO,CAAED,OAAO,CAAE,KAAK,CAAEC,KAAK,CAAEA,KAAK,CAACE,OAAQ,CAAC,CACjD,CACF,CAAC,CAED;AACA,MAAO,MAAM,CAAAe,gBAAgB,CAAG,KAAAA,CAAO9B,MAAM,CAAE+B,QAAQ,GAAK,CAC1D,GAAI,CACF,KAAM,CAAAC,OAAO,CAAG5C,GAAG,CAACU,EAAE,CAAE,OAAO,CAAEE,MAAM,CAAC,CACxC,KAAM,CAAAJ,SAAS,CAACoC,OAAO,CAAE,CACvBD,QAAQ,CAAEA,QAAQ,CAClBtB,SAAS,CAAE,GAAI,CAAAC,IAAI,CAAC,CACtB,CAAC,CAAC,CAEF,MAAO,CAAEE,OAAO,CAAE,IAAK,CAAC,CAC1B,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,6BAA6B,CAAEA,KAAK,CAAC,CACnD,MAAO,CAAED,OAAO,CAAE,KAAK,CAAEC,KAAK,CAAEA,KAAK,CAACE,OAAQ,CAAC,CACjD,CACF,CAAC,CAED;AACA,MAAO,MAAM,CAAAkB,cAAc,CAAG,KAAAA,CAAOjC,MAAM,CAAEC,IAAI,CAAEC,KAAK,GAAK,CAC3D,GAAI,CACF,KAAM,CAAAE,OAAO,IAAAC,MAAA,CAAMJ,IAAI,MAAAI,MAAA,CAAIC,MAAM,CAACJ,KAAK,CAAC,CAACK,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,CAAE,CAC3D,KAAM,CAAAC,MAAM,CAAGpB,GAAG,CAACU,EAAE,CAAE,aAAa,IAAAO,MAAA,CAAKL,MAAM,MAAAK,MAAA,CAAID,OAAO,CAAE,CAAC,CAC7D,KAAM,CAAAa,OAAO,CAAG,KAAM,CAAA3B,MAAM,CAACkB,MAAM,CAAC,CAEpC,GAAIS,OAAO,CAACC,MAAM,CAAC,CAAC,CAAE,CACpB,KAAM,CAAAf,IAAI,CAAGc,OAAO,CAACd,IAAI,CAAC,CAAC,CAC3B,MAAO,CACLS,OAAO,CAAE,IAAI,CACbT,IAAI,CAAEA,IACR,CAAC,CACH,CAAC,IAAM,CACL,MAAO,CACLS,OAAO,CAAE,IAAI,CACbT,IAAI,CAAE,IACR,CAAC,CACH,CACF,CAAE,MAAOU,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,4BAA4B,CAAEA,KAAK,CAAC,CAClD,MAAO,CAAED,OAAO,CAAE,KAAK,CAAEC,KAAK,CAAEA,KAAK,CAACE,OAAQ,CAAC,CACjD,CACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}