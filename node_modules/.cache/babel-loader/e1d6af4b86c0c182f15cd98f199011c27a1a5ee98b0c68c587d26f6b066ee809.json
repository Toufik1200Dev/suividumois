{"ast":null,"code":"import React from'react';import{BrowserRouter as Router,Routes,Route,Navigate}from'react-router-dom';import LoginPage from'./components/LoginPage';import ActivityTracker from'./components/ActivityTracker';import AdminDashboard from'./components/AdminDashboard';import{useState,useEffect}from'react';import{onAuthStateChange,signOutUser}from'./firebase/authService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[isAuthenticated,setIsAuthenticated]=useState(false);const[userRole,setUserRole]=useState('employee');const[user,setUser]=useState(null);const[isLoading,setIsLoading]=useState(true);useEffect(()=>{// Listen to authentication state changes\nconst unsubscribe=onAuthStateChange(user=>{console.log('Auth state changed, user:',user);if(user){setIsAuthenticated(true);setUser(user);setUserRole(user.role||'employee');console.log('User role:',user.role);}else{setIsAuthenticated(false);setUser(null);setUserRole('employee');}setIsLoading(false);});return()=>unsubscribe();},[]);const handleLogin=userData=>{// User is already authenticated by Firebase, just update state\nsetIsAuthenticated(true);setUser(userData);setUserRole(userData.role||'employee');};const handleLogout=async()=>{try{await signOutUser();// State will be updated by the auth state listener\n}catch(error){console.error('Logout error:',error);}};if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',height:'100vh',fontSize:'18px',color:'#20b2aa'},children:\"Loading...\"})});}return/*#__PURE__*/_jsx(Router,{future:{v7_startTransition:true,v7_relativeSplatPath:true},children:/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:isAuthenticated?userRole==='admin'?/*#__PURE__*/_jsx(Navigate,{to:\"/admin\",replace:true}):/*#__PURE__*/_jsx(Navigate,{to:\"/suivi-des-activity\",replace:true}):/*#__PURE__*/_jsx(LoginPage,{onLogin:handleLogin})}),/*#__PURE__*/_jsx(Route,{path:\"/suivi-des-activity\",element:isAuthenticated&&userRole==='employee'?/*#__PURE__*/_jsx(ActivityTracker,{onLogout:handleLogout,user:user}):/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true})}),/*#__PURE__*/_jsx(Route,{path:\"/admin\",element:isAuthenticated&&userRole==='admin'?/*#__PURE__*/_jsx(AdminDashboard,{onLogout:handleLogout}):/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true})})]})})});}export default App;","map":{"version":3,"names":["React","BrowserRouter","Router","Routes","Route","Navigate","LoginPage","ActivityTracker","AdminDashboard","useState","useEffect","onAuthStateChange","signOutUser","jsx","_jsx","jsxs","_jsxs","App","isAuthenticated","setIsAuthenticated","userRole","setUserRole","user","setUser","isLoading","setIsLoading","unsubscribe","console","log","role","handleLogin","userData","handleLogout","error","className","children","style","display","justifyContent","alignItems","height","fontSize","color","future","v7_startTransition","v7_relativeSplatPath","path","element","to","replace","onLogin","onLogout"],"sources":["C:/Users/rahma/OneDrive/Desktop/suivi du mois/src/App.js"],"sourcesContent":["import React from 'react';\r\nimport { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';\r\nimport LoginPage from './components/LoginPage';\r\nimport ActivityTracker from './components/ActivityTracker';\r\nimport AdminDashboard from './components/AdminDashboard';\r\nimport { useState, useEffect } from 'react';\r\nimport { onAuthStateChange, signOutUser } from './firebase/authService';\r\n\r\nfunction App() {\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [userRole, setUserRole] = useState('employee');\r\n  const [user, setUser] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    // Listen to authentication state changes\r\n    const unsubscribe = onAuthStateChange((user) => {\r\n      console.log('Auth state changed, user:', user);\r\n      if (user) {\r\n        setIsAuthenticated(true);\r\n        setUser(user);\r\n        setUserRole(user.role || 'employee');\r\n        console.log('User role:', user.role);\r\n      } else {\r\n        setIsAuthenticated(false);\r\n        setUser(null);\r\n        setUserRole('employee');\r\n      }\r\n      setIsLoading(false);\r\n    });\r\n\r\n    return () => unsubscribe();\r\n  }, []);\r\n\r\n  const handleLogin = (userData) => {\r\n    // User is already authenticated by Firebase, just update state\r\n    setIsAuthenticated(true);\r\n    setUser(userData);\r\n    setUserRole(userData.role || 'employee');\r\n  };\r\n\r\n  const handleLogout = async () => {\r\n    try {\r\n      await signOutUser();\r\n      // State will be updated by the auth state listener\r\n    } catch (error) {\r\n      console.error('Logout error:', error);\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"App\">\r\n        <div style={{ \r\n          display: 'flex', \r\n          justifyContent: 'center', \r\n          alignItems: 'center', \r\n          height: '100vh',\r\n          fontSize: '18px',\r\n          color: '#20b2aa'\r\n        }}>\r\n          Loading...\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Router future={{ v7_startTransition: true, v7_relativeSplatPath: true }}>\r\n      <div className=\"App\">\r\n        <Routes>\r\n          <Route \r\n            path=\"/\" \r\n            element={\r\n              isAuthenticated ? \r\n                (userRole === 'admin' ? \r\n                  <Navigate to=\"/admin\" replace /> : \r\n                  <Navigate to=\"/suivi-des-activity\" replace />\r\n                ) : \r\n                <LoginPage onLogin={handleLogin} />\r\n            } \r\n          />\r\n              <Route \r\n                path=\"/suivi-des-activity\" \r\n                element={\r\n                  isAuthenticated && userRole === 'employee' ? \r\n                    <ActivityTracker onLogout={handleLogout} user={user} /> : \r\n                    <Navigate to=\"/\" replace />\r\n                } \r\n              />\r\n          <Route \r\n            path=\"/admin\" \r\n            element={\r\n              isAuthenticated && userRole === 'admin' ? \r\n                <AdminDashboard onLogout={handleLogout} /> : \r\n                <Navigate to=\"/\" replace />\r\n            } \r\n          />\r\n        </Routes>\r\n      </div>\r\n    </Router>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}